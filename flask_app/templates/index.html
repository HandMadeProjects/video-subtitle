<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        #colorChangeDiv {
            width: 100%;
            height: 50px;
            text-align: center;
            line-height: 50px;
            font-size: 18px;
            color: white;
            transition: background-color 1s ease; /* Smooth color transition over 1 second */
        }
    </style>

    <title>Video Player with Subtitles</title>
</head>
<body id="colorChangeDiv" style="background-color: #333; color: #fff;" class="h-[570px]">

    <div class="border h-14 shadow-xl bg-gray-800">
        <a href="/" class="text-red-400 font-bold text-3xl p-1 text-center"><i class="fa-regular fa-circle-play ml-2"></i> PlayTube</a>
    <!-- <div id="colorChangeDiv" >Color Changing Div</div> -->

    </div>


    <div class="grid grid-cols-5 gap-4 mt-6">

        <div class="col-span-4 border mx-screen p-2 py-10 rounded-md hover:drop-shadow-[0_35px_35px_rgba(0,0,0,0.25)]">
            
            <video id="videoPlayer" width="900" height="600" controls class="mx-auto rounded-md">
                <source src="{{ video_path }}" type="video/mp4">
                <track src="{{ subtitle_path }}" kind="subtitles" srclang="en" label="English" default>
                Your browser does not support the video tag.
            </video>

            <div>
                <b>API : </b>
                <a class="border p-1 rounded-md" href="/get_video">get Video</a>
                <a class="border p-1 rounded-md" href="/get_subtitle">get Subtitle</a>
            </div>
            
        </div>

        <div class="border rounded-md">
            <div class="text-2xl my-4 font-bold">Playlist</div>

            <div class="text-md text-gray-400 border mx-2 my-1 rounded-md">video 2</div>
            <div class="text-md text-gray-400 border mx-2 my-1 rounded-md">video 3</div>
            <div class="text-md text-gray-400 border mx-2 my-1 rounded-md">video 4</div>
        </div>
    </div>
    

<script>
    const videoPlayer = document.getElementById('videoPlayer');
    videoPlayer.addEventListener('play', function () {
        // Display subtitles based on timestamp
        const subtitles = [
            { start: 0, end: 5, text: 'Demo subtitle at 0-5 seconds' },
            { start: 10, end: 15, text: 'Demo subtitle at 10-15 seconds' },
            // Add more subtitles as needed
        ];

        videoPlayer.addEventListener('timeupdate', function () {
            const currentTime = videoPlayer.currentTime;

            //for (const subtitle of subtitles) {
            //    if (currentTime >= subtitle.start && currentTime <= subtitle.end) {
            //        alert(subtitle.text); // Replace with your preferred way of displaying subtitles
            //    }
            //}
        });
    });

    const colorChangeDiv = document.getElementById('colorChangeDiv');
    let currentColorIndex = 0;

    //const colors = ['red', 'green', 'blue', 'orange', 'yellow'];

    const colors = ['#990000', '#003300', '#000066', '#994C00', '#999900'];
    //const colors = ['#994C00']; //fix color


    videoPlayer.addEventListener('play', function () {
        setInterval(() => {
            colorChangeDiv.style.backgroundColor = colors[currentColorIndex];
            currentColorIndex = (currentColorIndex + 1) % colors.length;
        }, 5000); // Change color every 5 seconds (adjust as needed)
    });
</script>

</body>
</html>
